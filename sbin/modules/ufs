--Uber File System Driver. Works with fsd.

ufs = {}

local oldfs = deepcopy(fs)

ufs.list = function(path)
  path = fs.normalizePath(path)
  if path == "/" then path = "" end
  local p = oldfs.list(path)
  for i = 1, #p do
    if path .. "/" .. p[i] == "/rom" then
      table.remove(p, i)
    end
  end
  return p
end

ufs = applyreadonly(ufs)
